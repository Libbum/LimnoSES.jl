<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · LimnoSES.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>LimnoSES.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#Quickstart"><span>Quickstart</span></a></li><li><a class="tocitem" href="#New-to-Julia"><span>New to Julia</span></a></li></ul></li><li><a class="tocitem" href="api/">Public API</a></li><li><a class="tocitem" href="dev/">Developer Docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Libbum/LimnoSES.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>LimnoSES.jl is a dynamical system, agent based model hybrid, focusing on socio-ecological interactions in lake systems.</p><p>Powered by the <a href="https://github.com/JuliaDynamics/Agents.jl">Agents.jl</a> ABM framework and the <a href="https://github.com/SciML/DifferentialEquations.jl">DifferentialEquations.jl</a> ecosystem.</p><h2 id="Quickstart"><a class="docs-heading-anchor" href="#Quickstart">Quickstart</a><a id="Quickstart-1"></a><a class="docs-heading-anchor-permalink" href="#Quickstart" title="Permalink"></a></h2><h3 id="Simple-Optimisation-Campaign"><a class="docs-heading-anchor" href="#Simple-Optimisation-Campaign">Simple Optimisation Campaign</a><a id="Simple-Optimisation-Campaign-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-Optimisation-Campaign" title="Permalink"></a></h3><p>An example run looking at a planting &amp; trawling campaign over 20 years, attempting to flip the lake state from Turbid to Clear with a 100 year time horizon</p><pre><code class="language-julia">using LimnoSES

model = initialise(;
    experiment = Experiment(
        policy = Decision(
            target = clear_state,
            objectives = objectives(objective(min_time), objective(min_cost)),
        ),
        identifier = &quot;Turbid-&gt;Clear, constant Nutrients&quot;,
        nutrient_series = Constant(),
    ),
    lake_setup = lake_initial_state(S1, Martin),
    municipalities = Dict(
        &quot;main&quot; =&gt; (
            Governance(
                interventions = planner(plan(Planting, 1:20), plan(Trawling, 1:20)),
                policies = policy(scan(Planting), scan(Trawling)),
            ),
            100,
        ),
    ),
)

function assets(model)
    nutrients(model) = model.lake.p.nutrients
    plant_rate(model) = model.lake.p.pv
    trawl_rate(model) = model.lake.p.tb
    return [nutrients, plant_rate, trawl_rate]
end

_, data = run!(model, agent_step!, model_step!, 100; mdata = assets(model))

using Plots

discrete = model.lake.sol(0:12:365*100)

hl = plot(
    discrete;
    labels = [&quot;Bream&quot; &quot;Pike&quot; &quot;Vegetation&quot;],
    xticks = (0:365*5:365*100, 0:5:100),
)
hr = plot([data.plant_rate data.trawl_rate], labels = [&quot;Plant Rate&quot; &quot;Trawl Rate&quot;])
hn = plot(data.nutrients, label = &quot;Nutrients&quot;)
l = @layout [a; b c]
plot(hl, hr, hn, layout = l, size = (1000, 700))</code></pre><h3 id="Stochastic-Distributed-Campaign"><a class="docs-heading-anchor" href="#Stochastic-Distributed-Campaign">Stochastic Distributed Campaign</a><a id="Stochastic-Distributed-Campaign-1"></a><a class="docs-heading-anchor-permalink" href="#Stochastic-Distributed-Campaign" title="Permalink"></a></h3><p>A 20 year planting campaign, 100 year time horizon and Turbid to Clear target. This time using geometric Brownian motion within the bistable corridor to simulate wending nutrient levels. 10 complete runs, each with 10 projected optimiser calls with new random seeds on the nutrient noise process. Distributed over as many process as you wish, this example uses one control and 13 workers.</p><pre><code class="language-julia">using Distributed
addprocs(13)
@everywhere begin
    import Pkg
    Pkg.activate(@__DIR__)
end

@everywhere using LimnoSES
@everywhere model = initialise(;
    experiment = Experiment(
        policy = Decision(
            target = clear_state,
            objectives = objectives(objective(min_time), objective(min_cost)),
            opt_replicates = 10,
        ),
        identifier = &quot;noisy_N, Turbid-&gt;Clear&quot;,
        nutrient_series = Noise(
            GeometricBrownianMotionProcess(0.0, 0.05, 0.0, 2.0),
            1.0,
            2.5,
        ),
    ),
    lake_setup = lake_initial_state(S1, Martin),
    municipalities = Dict(
        &quot;main&quot; =&gt; (
            Governance(
                interventions = planner(plan(Planting, 1:20)),
                policies = policy(scan(Planting)),
            ),
            100,
        ),
    ),
)

@everywhere function assets(model)
    nutrients(model) = model.lake.p.nutrients
    plant_rate(model) = model.lake.p.pv
    trawl_rate(model) = model.lake.p.tb
    discrete(model) = model.lake.sol(
        (model.year &gt; 1 ? 365 * (model.year - 1) + 36.5 : 0):36.5:365*model.year,
    )
    return [nutrients, plant_rate, trawl_rate, discrete]
end

reps = 10
years = 100
_, data = replicates(model, agent_step!, model_step!, years, reps; mdata = assets(model))

using Plots, Statistics, DataFrames

discrete = LimnoSES.OrdinaryDiffEq.VectorOfArray([
    cat(
        collect(Iterators.flatten(
            d.u
            for
            d in
            DataFrames.filter(
                [:replicate, :step] =&gt; (r, s) -&gt; r == i &amp;&amp; s != 0,
                data,
            ).discrete
        ))...,
        dims = 2,
    ) for i in 1:reps
])
t = 0:36.5:365*years

hl = plot(
    t,
    mean(discrete[1, :, :], dims = 2),
    ribbon = std(discrete[1, :, :], dims = 2),
    label = &quot;Bream&quot;,
    linewidth = 2,
    xticks = (0:365*5:365*years, 0:5:years),
)
plot!(
    hl,
    t,
    mean(discrete[2, :, :], dims = 2),
    ribbon = std(discrete[2, :, :], dims = 2),
    label = &quot;Pike&quot;,
    linewidth = 2,
)
plot!(
    hl,
    t,
    mean(discrete[3, :, :], dims = 2),
    ribbon = std(discrete[3, :, :], dims = 2),
    label = &quot;Vegetation&quot;,
    linewidth = 2,
)

plant_rate = reshape(data.plant_rate, (years + 1, reps))
hr = plot(
    mean(plant_rate, dims = 2),
    ribbon = std(plant_rate, dims = 2),
    label = &quot;Plant Rate&quot;,
    linewidth = 2,
    color = palette(:default)[3],
)
nut = reshape(data.nutrients, (years + 1, reps))
hn = plot(
    mean(nut, dims = 2),
    ribbon = std(nut, dims = 2),
    label = &quot;Nutrients&quot;,
    linewidth = 2,
)
l = @layout [a; b c]
plot(hl, hr, hn, layout = l, size = (1000, 700))</code></pre><h2 id="New-to-Julia"><a class="docs-heading-anchor" href="#New-to-Julia">New to Julia</a><a id="New-to-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#New-to-Julia" title="Permalink"></a></h2><p>If you&#39;ve never used Julia before there are a few things you will need to do to get LimnoSES running.</p><h3 id="Install-Julia"><a class="docs-heading-anchor" href="#Install-Julia">Install Julia</a><a id="Install-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Install-Julia" title="Permalink"></a></h3><p>First, you&#39;ll need the Julia runtime. Install the version for your operating system from <a href="https://julialang.org/downloads/">this link</a>. You&#39;ll want the current stable release (v1.6.x at time of writing).</p><h3 id="Adding-LimnoSES"><a class="docs-heading-anchor" href="#Adding-LimnoSES">Adding LimnoSES</a><a id="Adding-LimnoSES-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-LimnoSES" title="Permalink"></a></h3><p>Now you&#39;ll need to add the LimnoSES package to your system. Open the Julia REPL (short for Read-eval-print loop: it&#39;s the Julia command line). On linux and mac systems you can type <code>julia</code> at a prompt. For windows you can probably do the same or click an icon.</p><p>It&#39;s nice to do this from a specific directory you want to work in, so if you&#39;re using a prompt: first make one, <code>cd</code> into it and then start <code>julia</code>. Starting from an icon, try <code>cd(&quot;working/directory/path&quot;)</code>. You can use <code>pwd()</code> to make sure you&#39;re in the right place.</p><p>Now press <code>]</code> to get into the REPL&#39;s package mode - you should see a <code>(@v1.6) pkg&gt;</code> prompt. We&#39;re going to create a new project which is called whatever you named your folder. Say your folder was called <code>shallow_lake</code>, what we want to do at this prompt is type <code>activate .</code>. Now your prompt looks like: <code>(shallow_lake) pkg&gt;</code>.</p><p>Since LimnoSES is in development, we add it like this:</p><p><code>add https://github.com/Libbum/LimnoSES.jl</code></p><p>In the near future it will be simpler, just <code>add LimnoSES</code>, but not right away.</p><p>Once the install is sorted, you can press backspace to get back to the green <code>julia&gt;</code> prompt and type <code>using LimnoSES</code>. If all goes well you&#39;re ready!</p><p>Now you can go through the <a href="#Quickstart">Quickstart</a> section.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api/">Public API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 13 June 2021 13:21">Sunday 13 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
